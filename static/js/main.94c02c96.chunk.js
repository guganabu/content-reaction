(this["webpackJsonpcontent-reaction"]=this["webpackJsonpcontent-reaction"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},48:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),i=n(21),s=n.n(i),r=(n(27),n(28),n(7)),o=n(6),u=n(4),j=(n(29),n(5)),d=n.n(j);n(48);var l=n(0);var b=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),a=n[0],i=n[1],s=Object(c.useState)([]),o=Object(u.a)(s,2),j=o[0],b=o[1];Object(c.useEffect)((function(){d.a.get("https://artful-iudex.herokuapp.com/users").then((function(e){i(e.data)}))}),[]),Object(c.useEffect)((function(){b("all"===e.activeTab?e.userReactions:Object(r.a)(e.userReactions.filter((function(t){return t.reaction_id===e.activeTab}))))}),[e.activeTab,e.userReactions]);var m=function(){return Object(l.jsxs)("ul",{className:"ReactionSummaryTab",children:[Object(l.jsx)("li",{className:"ReactionSummaryTab-item ".concat("all"===e.activeTab?"active":""),onClick:function(){return e.onTabChange("all")},children:Object(l.jsx)("span",{children:"All"})},"all"),e.reactedCounts.map((function(t){return t.count>=1&&Object(l.jsxs)("li",{className:"ReactionSummaryTab-item ".concat(e.activeTab===t.id?"active":""),onClick:function(){return e.onTabChange(t.id)},children:[Object(l.jsx)("span",{children:t.emoji}),Object(l.jsx)("span",{children:"\xb7"}),Object(l.jsx)("span",{children:t.count})]},t.id)}))]})},O=function(){return Object(l.jsx)("div",{className:"ReactionSummaryDetails",children:j.map((function(t,n){var c=a.find((function(e){return e.id===t.user_id})),i=e.reactions.find((function(e){return e.id===t.reaction_id}));return Object(l.jsxs)("div",{className:"ReactionSummaryDetails-item",children:[Object(l.jsx)("img",{src:c.avatar,className:"user-avatar",alt:"avatar"}),Object(l.jsx)("span",{className:"user-reacted-emoji",children:i?i.emoji:""}),Object(l.jsx)("span",{className:"user-name",children:c?c.last_name+" "+c.first_name:""})]},n)}))})};return Object(l.jsxs)("div",{style:e.style,className:"ReactionSummary",children:[Object(l.jsx)("div",{className:"ReactionSummary-title",children:"Reactions"}),Object(l.jsx)(m,{}),Object(l.jsx)(O,{})]})},m=n(22);var O=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),a=n[0],i=n[1],s=Object(c.useState)([]),j=Object(u.a)(s,2),O=j[0],f=j[1],h=Object(c.useState)(!1),x=Object(u.a)(h,2),p=x[0],v=x[1],g=Object(c.useState)([]),N=Object(u.a)(g,2),R=N[0],_=N[1],C=Object(c.useState)(!1),I=Object(u.a)(C,2),S=I[0],y=I[1],T=Object(c.useState)(),k=Object(u.a)(T,2),E=k[0],B=k[1],U=Object(c.useState)([]),M=Object(u.a)(U,2),w=M[0],F=M[1];Object(c.useEffect)((function(){var t;Promise.all([d.a.get("https://artful-iudex.herokuapp.com/reactions"),(t={content_id:e.contentId},d.a.get("https://artful-iudex.herokuapp.com/user_content_reactions",{params:t}))]).then((function(t){var n,c,a=Object(u.a)(t,2),s=a[0],r=a[1];i(s.data),_(r.data),f((n=s.data,c=r.data,n.map((function(t){var n=c.filter((function(e){return e.reaction_id===t.id}));return Object(o.a)(Object(o.a)({},t),{},{count:n.length,isUserReacted:!!n.find((function(t){return t.user_id===e.userId}))})}))))}))}),[e.userId,e.contentId]),Object(c.useEffect)((function(){F(R.filter((function(t){return t.user_id===e.userId})))}),[e.userId,R]);var L=function(t){v(!1);var n,c,a=R.findIndex((function(n){return n.reaction_id===t.id&&n.user_id===e.userId}));if(a>=0)(c=R[a].id,d.a.delete("https://artful-iudex.herokuapp.com/user_content_reactions/".concat(c))).then((function(){D(t),R.splice(a,1),_(Object(r.a)(R))}));else{var i={reaction_id:t.id,user_id:e.userId,content_id:e.contentId};(n=i,d.a.post("https://artful-iudex.herokuapp.com/user_content_reactions",{params:n})).then((function(e){D(t),R.push(Object(o.a)(Object(o.a)({},i),{},{id:e.data.id})),_(Object(r.a)(R))}))}};function D(e){var t=O.find((function(t){return t.id===e.id}));t?!function(e){return!!w.find((function(t){return t.reaction_id===e.id}))}(e)?(t.count+=1,t.isUserReacted=!0):(t.count-=1,t.isUserReacted=!1):O.push(Object(o.a)(Object(o.a)({},e),{},{count:1,isUserReacted:!0})),f(Object(r.a)(O))}var P=function(){return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("ul",{className:"ReactionEmojis",children:a.map((function(e){return Object(l.jsx)("li",{className:"ReactionEmojis-item","data-for":"trigger-emoji","data-tip":e.name,"data-offset":"{'top': 5}",children:Object(l.jsx)("button",{className:"ReactionEmojis-btn",onClick:function(){return L(e)},children:Object(l.jsx)("span",{className:"emoji",children:e.emoji})})},e.id)}))}),Object(l.jsx)(m.a,{id:"trigger-emoji",className:"EmojiTooltip",backgroundColor:"#161616",place:"top",type:"dark",effect:"solid"})]})},A=function(){return Object(l.jsx)("button",{className:"ReactionEmojiTriggerBtn",onClick:function(){return v(!p)},children:Object(l.jsx)("img",{className:"ReactionEmojiTriggerBtn-emoji",src:"./emoji-add.svg",alt:"emoji-add"})})},J=function(){return Object(l.jsx)("div",{className:"ReactedCounts",children:O.map((function(e){return e.count>=1&&Object(l.jsxs)("button",{className:"ReactedCounts-btn ".concat(e.isUserReacted?"active":""),onClick:function(){return L(e)},onMouseOver:function(){return function(e,t){y(e),B(t.id)}(!0,e)},onMouseLeave:function(){return y(!1)},"data-for":"reaction-summary",children:[Object(l.jsx)("span",{children:e.emoji}),Object(l.jsx)("span",{children:"\xb7"}),Object(l.jsx)("span",{children:e.count})]},e.id)}))})};return Object(l.jsxs)("div",{className:"Reaction",children:[Object(l.jsxs)("div",{className:"Reaction-container",children:[p&&Object(l.jsx)(P,{}),Object(l.jsxs)("div",{className:"Reaction-trigger-count",children:[Object(l.jsx)(A,{}),Object(l.jsx)(J,{})]})]}),Object(l.jsx)("div",{className:"Reaction-summary-container ".concat(S?"show":"hide"),onMouseMove:function(){return y(!0)},onMouseLeave:function(){return y(!1)},children:Object(l.jsx)(b,{reactions:a,reactedCounts:O,userReactions:R,activeTab:E,onTabChange:B})})]})};var f=function(){return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsxs)("div",{className:"Content",children:[Object(l.jsxs)("div",{className:"Body",children:[Object(l.jsx)("img",{src:"/logo192.png",width:"60",alt:"logo"}),Object(l.jsxs)("div",{className:"Body-content",children:[Object(l.jsx)("span",{children:"UserId: 10"})," ",Object(l.jsx)("span",{children:"ContentId: 1"})]})]}),Object(l.jsx)(O,{userId:10,contentId:1})]}),Object(l.jsxs)("div",{className:"Content",children:[Object(l.jsxs)("div",{className:"Body",children:[Object(l.jsx)("img",{src:"/logo192.png",width:"60",alt:"logo"}),Object(l.jsxs)("div",{className:"Body-content",children:[Object(l.jsx)("span",{children:"UserId: 1"})," ",Object(l.jsx)("span",{children:"ContentId: 2"})]})]}),Object(l.jsx)(O,{userId:1,contentId:2})]})]})},h=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,56)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(f,{})}),document.getElementById("root")),h()}},[[53,1,2]]]);
//# sourceMappingURL=main.94c02c96.chunk.js.map