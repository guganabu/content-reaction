(this["webpackJsonpcontent-reaction"]=this["webpackJsonpcontent-reaction"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},48:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),i=n(21),s=n.n(i),r=(n(27),n(28),n(7)),o=n(6),u=n(4),j=(n(29),n(5)),d=n.n(j),l="https://artful-iudex.herokuapp.com";n(48);var b=n(0);var m=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),a=n[0],i=n[1],s=Object(c.useState)([]),o=Object(u.a)(s,2),j=o[0],l=o[1];Object(c.useEffect)((function(){d.a.get("".concat("https://artful-iudex.herokuapp.com","/users")).then((function(e){i(e.data)}))}),[]),Object(c.useEffect)((function(){l("all"===e.activeTab?e.userReactions:Object(r.a)(e.userReactions.filter((function(t){return t.reaction_id===e.activeTab}))))}),[e.activeTab,e.userReactions]);var m=function(){return Object(b.jsxs)("ul",{className:"ReactionSummaryTab",children:[Object(b.jsx)("li",{className:"ReactionSummaryTab-item ".concat("all"===e.activeTab?"active":""),onClick:function(){return e.onTabChange("all")},children:Object(b.jsx)("span",{children:"All"})},"all"),e.reactedCounts.map((function(t){return t.count>=1&&Object(b.jsxs)("li",{className:"ReactionSummaryTab-item ".concat(e.activeTab===t.id?"active":""),onClick:function(){return e.onTabChange(t.id)},children:[Object(b.jsx)("span",{children:t.emoji}),Object(b.jsx)("span",{children:"\xb7"}),Object(b.jsx)("span",{children:t.count})]},t.id)}))]})},O=function(){return Object(b.jsx)("div",{className:"ReactionSummaryDetails",children:j.map((function(t,n){var c=a.find((function(e){return e.id===t.user_id})),i=e.reactions.find((function(e){return e.id===t.reaction_id}));return Object(b.jsxs)("div",{className:"ReactionSummaryDetails-item",children:[Object(b.jsx)("img",{src:c.avatar,className:"user-avatar",alt:"avatar"}),Object(b.jsx)("span",{className:"user-reacted-emoji",children:i?i.emoji:""}),Object(b.jsx)("span",{className:"user-name",children:c?c.last_name+" "+c.first_name:""})]},n)}))})};return Object(b.jsxs)("div",{style:e.style,className:"ReactionSummary",children:[Object(b.jsx)("div",{className:"ReactionSummary-title",children:"Reactions"}),Object(b.jsx)(m,{}),Object(b.jsx)(O,{})]})},O=n(22);var f=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),a=n[0],i=n[1],s=Object(c.useState)([]),j=Object(u.a)(s,2),f=j[0],h=j[1],x=Object(c.useState)(!1),v=Object(u.a)(x,2),p=v[0],g=v[1],N=Object(c.useState)([]),R=Object(u.a)(N,2),_=R[0],C=R[1],I=Object(c.useState)(!1),S=Object(u.a)(I,2),y=S[0],T=S[1],k=Object(c.useState)(),E=Object(u.a)(k,2),w=E[0],B=E[1],M=Object(c.useState)([]),U=Object(u.a)(M,2),F=U[0],L=U[1];Object(c.useEffect)((function(){var t;Promise.all([d.a.get("".concat(l,"/reactions")),(t={content_id:e.contentId},d.a.get("".concat(l,"/user_content_reactions"),{params:t}))]).then((function(t){var n,c,a=Object(u.a)(t,2),s=a[0],r=a[1];i(s.data),C(r.data),h((n=s.data,c=r.data,n.map((function(t){var n=c.filter((function(e){return e.reaction_id===t.id}));return Object(o.a)(Object(o.a)({},t),{},{count:n.length,isUserReacted:!!n.find((function(t){return t.user_id===e.userId}))})}))))}))}),[e.userId,e.contentId]),Object(c.useEffect)((function(){L(_.filter((function(t){return t.user_id===e.userId})))}),[e.userId,_]);var D=function(t){g(!1);var n,c,a=_.findIndex((function(n){return n.reaction_id===t.id&&n.user_id===e.userId}));if(a>=0)(c=_[a].id,d.a.delete("".concat(l,"/user_content_reactions/").concat(c))).then((function(){P(t),_.splice(a,1),C(Object(r.a)(_))}));else{var i={reaction_id:t.id,user_id:e.userId,content_id:e.contentId};(n=i,d.a.post("".concat(l,"/user_content_reactions"),{params:n})).then((function(e){P(t),_.push(Object(o.a)(Object(o.a)({},i),{},{id:e.data.id})),C(Object(r.a)(_))}))}};function P(e){var t=f.find((function(t){return t.id===e.id}));t?!function(e){return!!F.find((function(t){return t.reaction_id===e.id}))}(e)?(t.count+=1,t.isUserReacted=!0):(t.count-=1,t.isUserReacted=!1):f.push(Object(o.a)(Object(o.a)({},e),{},{count:1,isUserReacted:!0})),h(Object(r.a)(f))}var A=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("ul",{className:"ReactionEmojis",children:a.map((function(e){return Object(b.jsx)("li",{className:"ReactionEmojis-item","data-for":"trigger-emoji","data-tip":e.name,"data-offset":"{'top': 5}",children:Object(b.jsx)("button",{className:"ReactionEmojis-btn",onClick:function(){return D(e)},children:Object(b.jsx)("span",{className:"emoji",children:e.emoji})})},e.id)}))}),Object(b.jsx)(O.a,{id:"trigger-emoji",className:"EmojiTooltip",backgroundColor:"#161616",place:"top",type:"dark",effect:"solid"})]})},J=function(){return Object(b.jsx)("button",{className:"ReactionEmojiTriggerBtn",onClick:function(){return g(!p)},children:Object(b.jsx)("img",{className:"ReactionEmojiTriggerBtn-emoji",src:"./emoji-add.svg",alt:"emoji-add"})})},q=function(){return Object(b.jsx)("div",{className:"ReactedCounts",onMouseLeave:function(){return T(!1)},children:f.map((function(e){return e.count>=1&&Object(b.jsxs)("button",{className:"ReactedCounts-btn ".concat(e.isUserReacted?"active":""),onClick:function(){return D(e)},onMouseMove:function(){B(e.id),T(!0)},"data-for":"reaction-summary",children:[Object(b.jsx)("span",{children:e.emoji}),Object(b.jsx)("span",{children:"\xb7"}),Object(b.jsx)("span",{children:e.count})]},e.id)}))})};return Object(b.jsxs)("div",{className:"Reaction",children:[Object(b.jsxs)("div",{className:"Reaction-container",children:[p&&Object(b.jsx)(A,{}),Object(b.jsxs)("div",{className:"Reaction-trigger-count",children:[Object(b.jsx)(J,{}),Object(b.jsx)(q,{})]})]}),Object(b.jsx)("div",{className:"Reaction-summary-container ".concat(y?"show":"hide"),onMouseMove:function(){return T(!0)},onMouseLeave:function(){return T(!1)},children:Object(b.jsx)(m,{reactions:a,reactedCounts:f,userReactions:_,activeTab:w,onTabChange:B})})]})};var h=function(){return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsxs)("div",{className:"Content",children:[Object(b.jsxs)("div",{className:"Body",children:[Object(b.jsx)("img",{src:window.location.href+"logo192.png",width:"60",alt:"logo"}),Object(b.jsxs)("div",{className:"Body-content",children:[Object(b.jsx)("span",{children:"UserId: 10"})," ",Object(b.jsx)("span",{children:"ContentId: 1"})]})]}),Object(b.jsx)(f,{userId:10,contentId:1})]}),Object(b.jsxs)("div",{className:"Content",children:[Object(b.jsxs)("div",{className:"Body",children:[Object(b.jsx)("img",{src:window.location.href+"logo192.png",width:"60",alt:"logo"}),Object(b.jsxs)("div",{className:"Body-content",children:[Object(b.jsx)("span",{children:"UserId: 1"})," ",Object(b.jsx)("span",{children:"ContentId: 2"})]})]}),Object(b.jsx)(f,{userId:1,contentId:2})]})]})},x=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,56)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),i(e),s(e)}))};s.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(h,{})}),document.getElementById("root")),x()}},[[53,1,2]]]);
//# sourceMappingURL=main.a51f45d7.chunk.js.map